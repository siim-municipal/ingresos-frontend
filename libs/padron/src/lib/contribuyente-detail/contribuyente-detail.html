<div
  class="mt-6 border border-slate-200 rounded-xl overflow-hidden shadow-sm bg-white animate-fade-in-up"
>
  <div
    class="px-6 py-4 border-b border-slate-100 flex justify-between items-start gap-4"
    [class.bg-purple-50]="contribuyente().tipoPersona === 'FISICA'"
    [class.bg-emerald-50]="contribuyente().tipoPersona === 'MORAL'"
  >
    <div>
      <h3 class="text-lg font-bold text-slate-800">
        {{ contribuyente().nombreCompleto }}
      </h3>
      <div class="flex items-center gap-2 mt-1">
        <span
          class="text-xs font-mono font-medium text-slate-600 bg-white/50 px-2 py-0.5 rounded border border-slate-200/50"
        >
          RFC: {{ contribuyente().rfc }}
        </span>
      </div>
    </div>

    <span
      class="shrink-0 px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider border bg-white shadow-sm"
      [class.text-purple-700]="contribuyente().tipoPersona === 'FISICA'"
      [class.border-purple-200]="contribuyente().tipoPersona === 'FISICA'"
      [class.text-emerald-700]="contribuyente().tipoPersona === 'MORAL'"
      [class.border-emerald-200]="contribuyente().tipoPersona === 'MORAL'"
    >
      {{ contribuyente().tipoPersona }}
    </span>
  </div>

  <div
    class="p-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-y-6 gap-x-8"
  >
    <div class="space-y-4">
      <h4
        class="text-xs font-bold text-slate-400 uppercase tracking-wider border-b border-slate-100 pb-1 mb-2"
      >
        Información General
      </h4>

      <div>
        <span class="text-[10px] text-slate-500 block mb-0.5"
          >Fecha de Registro</span
        >
        <p class="text-sm font-medium text-slate-700 flex items-center gap-2">
          <span class="material-icons text-[14px] text-slate-400"
            >calendar_today</span
          >
          <!-- TODO: incluir en el DTO del back la fecha creacion -->
          {{ contribuyente().fechaRegistro| date:'longDate' }}
        </p>
      </div>

      <div>
        <span class="text-[10px] text-slate-500 block mb-0.5"
          >Correo Electrónico</span
        >
        <p class="text-sm text-slate-700 flex items-center gap-2">
          <span class="material-icons text-[14px] text-slate-400">email</span>
          @if (contribuyente().datosAdicionales.email) {
          <a
            [href]="'mailto:' + contribuyente().datosAdicionales.email"
            class="hover:text-blue-600 hover:underline"
          >
            {{ contribuyente().datosAdicionales.email | lowercase }}
          </a>
          } @else {
          <span class="text-slate-400 italic">No registrado</span>
          }
        </p>
      </div>

      <div>
        <span class="text-[10px] text-slate-500 block mb-0.5"
          >Teléfono Móvil</span
        >
        <p class="text-sm text-slate-700 flex items-center gap-2">
          <span class="material-icons text-[14px] text-slate-400"
            >smartphone</span
          >
          @if (contribuyente().datosAdicionales.telefono) { {{
          contribuyente().datosAdicionales.telefono }} } @else {
          <span class="text-slate-400 italic">No registrado</span>
          }
        </p>
      </div>
    </div>

    <div class="space-y-4">
      <h4
        class="text-xs font-bold text-slate-400 uppercase tracking-wider border-b border-slate-100 pb-1 mb-2"
      >
        Datos Fiscales
      </h4>

      @if (contribuyente().tipoPersona === 'FISICA') {
      <div>
        <span class="text-[10px] text-slate-500 block mb-0.5">CURP</span>
        <p
          class="text-sm font-mono text-slate-700 bg-slate-50 px-2 py-1 rounded border border-slate-100 inline-block"
        >
          {{ contribuyente().datosAdicionales.curp || 'No registrada' |
          uppercase }}
        </p>
      </div>
      } @if (contribuyente().tipoPersona === 'MORAL') {
      <div>
        <span class="text-[10px] text-slate-500 block mb-0.5"
          >Constitución de la Empresa</span
        >
        <p class="text-sm text-slate-700">
          {{ contribuyente().datosAdicionales.fechaConstitucion ?
          (contribuyente().datosAdicionales.fechaConstitucion | date:'longDate')
          : 'No registrada' }}
        </p>
      </div>
      }
    </div>

    <div class="space-y-4 md:col-span-2 lg:col-span-1">
      <h4
        class="text-xs font-bold text-slate-400 uppercase tracking-wider border-b border-slate-100 pb-1 mb-2"
      >
        Domicilio Fiscal
      </h4>

      <div class="bg-slate-50 p-3 rounded-lg border border-slate-100">
        <div class="flex items-start gap-2">
          <span class="material-icons text-slate-400 text-lg mt-0.5"
            >place</span
          >
          <div>
            <p class="text-sm font-medium text-slate-800 leading-snug">
              {{ contribuyente().domicilio.calle || 'Dirección no disponible' |
              uppercase }}
            </p>
            <p class="text-xs text-slate-500 mt-1">
              {{ contribuyente().domicilio.colonia }} @if
              (contribuyente().domicilio.codigoPostal) { - C.P. {{
              contribuyente().domicilio.codigoPostal }} }
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div
    class="bg-slate-50 px-6 py-3 border-t border-slate-100 flex justify-between items-center"
  >
    <span class="text-[10px] text-slate-400">
      Identificador: {{ contribuyente().id }}
    </span>

    <div class="flex gap-3">
      <button
        (click)="closeAction.emit()"
        class="text-slate-500 hover:text-slate-700 text-sm font-medium px-3 py-2 transition-colors"
      >
        Cerrar
      </button>

      <button
        (click)="editAction.emit(contribuyente().id)"
        class="bg-blue-600 text-white text-sm font-medium px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors shadow-sm flex items-center gap-2"
      >
        <span class="material-icons text-xs">edit</span>
        Editar Datos
      </button>
    </div>
  </div>
</div>
